name: unit-tests
on: [push]
jobs:
  run:
    runs-on: windows
    strategy:
      matrix:
        os: [windows]
        python-version: [3.7]
      fail-fast: false

    steps:
    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v1
      with:
        python-version: ${{ matrix.python-version }}
        
    - run: pip install stanza
    - run: |
    echo "import stanza                                                                                                                     ─╯
from stanza.server import CoreNLPClient

stanza.install_corenlp()

client = CoreNLPClient(port=8888)
client.start()

# Wait for server to start
client.ensure_alive()

# Get its PID
pid = client.server.pid
print(f"Process running on: {pid if pid else 'Cant find pid'}")


# client.stop()
client.stop()

# Make sure server has shut down
assert not client.server
" > test.py
  - run: python run.py
  - run: python run.py
